<project name="NGO Web Deployment Ant Utility" default="compile" basedir="D:/Km/NOC/apache-tomcat-8.0.46/webapps/ROOT">

	<property name="tomcat.home" value="D:/Km/NOC/apache-tomcat-8.0.46" />

	<!-- Configure the directory into which the web application is built -->
	<property name="build" value="${basedir}/WEB-INF/classes" />
	<property name="dist.dir" value="D:/Km/NOC/upload/web" />

	<!-- Configure the context path for this application -->
	<property name="path" value="/ROOT" />

	<!-- Configure properties to access the Manager application -->
	<property name="url" value="http://127.0.0.1:9080/manager/text" />
	<property name="username" value="ngoweba" />
	<property name="password" value="NeverSt9p!" />

	<path id="catalina-ant-classpath">
		<fileset dir="${tomcat.home}/lib">
			<include name="catalina-ant.jar" />
			<include name="tomcat-coyote.jar" />
			<include name="tomcat-util.jar" />
		</fileset>
		<fileset dir="${tomcat.home}/bin">
			<include name="tomcat-juli.jar" />
		</fileset>
	</path>
	<taskdef file="${basedir}/util/ant/tomcatTasks.properties">
		<classpath refid="catalina-ant-classpath" />
	</taskdef>


	<path id="ngo-ant-classpath">
		<fileset dir="${basedir}/util/ant/lib">
			<include name="ngotask.jar" />
		</fileset>
		<fileset dir="${basedir}/util/jsc">
			<include name="yuicompressor-2.4.8.jar" />
			<include name="commons-io-2.5.jar" />
		</fileset>
		<fileset dir="${basedir}/util/gzip">
			<include name="commons-compress-1.14.jar" />
		</fileset>
	</path>
	<taskdef file="${basedir}/util/ant/ngoTasks.properties">
		<classpath refid="ngo-ant-classpath" />
	</taskdef>


	<!-- basic targets -->
	<target name="clean">
		<delete dir="${dest.dir}" />
		<echo message="File folder ${dist.dir} cleaned" />
	</target>


	<target name="compile" description="compile files" depends="clean">
		<mkdir dir="${dist.dir}" />
		<war destfile="${dist.dir}/ROOT.war" webxml="WEB-INF/web.xml">
			<classes dir="WEB-INF/classes" />
			<fileset dir="." excludes="WEB-INF/**" />
			<lib dir="WEB-INF/lib" />
		</war>
	</target>

	<!-- NGO resource package -->
	<target name="JsConfusion" description="Javascript compression">
		<confusion include=".*\.js" exclude=".*\.min\.js" fileExtension="min.js" path="${basedir}" />
	</target>

	<target name="JsGzip" description="Confusion and Gzip for javascript " depends="JsConfusion">
			<ngzip include=".*\.min\.js" exclude="__NOMATCH__" fileExtension="ngjs" path="${basedir}" executable="common-compression" />
	</target>
	
	<!--This task is only for DEV debug purpose only-->
	<target name="JsGzip-NO-Confusion" description="Javascript Gzip with raw javascript">
		<ngzip include=".*\.js" exclude=".*\.min\.js" fileExtension="min.ngjs" path="${basedir}" executable="common-compression" />
	</target>
	

	<!-- NGO web manager interface -->


	<!-- Tomcat manager interface -->
	<target name="deploy" description="Install web application" depends="compile">
		<deploy url="${url}" username="${username}" password="${password}" path="${path}" war="${dist.dir}/ROOT.war" />
	</target>

	<target name="reload" description="Reload web application" depends="compile">
		<reload url="${url}" username="${username}" password="${password}" path="${path}" />
	</target>

	<target name="undeploy" description="Remove web application">
		<undeploy url="${url}" username="${username}" password="${password}" path="${path}" />
	</target>


</project>