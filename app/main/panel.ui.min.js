var PANEL=(function(d){d.name="NGO Panel GUI v8";d.bgcontainer=$("#background_screen");d.bgcanvas=$("<canvas>").css({position:"absolute",left:0,top:0,width:"100%",height:"100%"}).attr({id:"backgound_canvas",width:d.bgcontainer.width(),height:d.bgcontainer.height()}).prependTo(d.bgcontainer);d.bgeffects=function(){if(AppSettings.bganimate){$(d.bgcontainer).starfield({framerate:AppSettings.framerate,speedX:2,starDensity:0.1,mouseScale:0.01,background:"#000007",seedMovement:true},"backgound_canvas")}};d.panelId="panel_canvas";d.panel=$("<canvas>").addClass("panel_canvas").attr({id:d.panelId}).appendTo($("#ngcontainer"));d.screenStatus={isFull:false,orientation:0};d.dimension={width:0,height:0,hwidth:0,hheight:0,swidth:0,sheight:0,awidth:0,aheight:0};var f=[[1600,900],[1440,810],[1280,720],[1120,630],[960,540],[800,450],[640,360],[600,340],[340,240]];var e=[[1600,80],[1440,80],[1280,80],[1120,60],[960,60],[800,40],[640,40],[600,40],[340,40]];var a=[[1600,"320,820"],[1440,"320,730"],[1280,"320,640"],[1120,"240,570"],[960,"240,480"],[800,"180,410"],[640,"180,320"],[600,"180,300"],[340,"0,0"]];d.isFullscreen=function(){return document.fullscreenElement||document.msFullscreenElement||document.mozFullScreenElement||document.webkitFullscreenElement||false};d.fullScreen=function(){var g=document.documentElement;if(g.requestFullscreen){g.requestFullscreen()}else{if(g.msRequestFullscreen){g=document.body;g.msRequestFullscreen()}else{if(g.mozRequestFullScreen){g.mozRequestFullScreen()}else{if(g.webkitRequestFullScreen){g.webkitRequestFullScreen()}else{if(g.webkitEnterFullscreen){g.webkitEnterFullscreen()}}}}}};d.exitFullScreen=function(){if(document.exitFullscreen){document.exitFullscreen()}else{if(document.msExitFullscreen){document.msExitFullscreen()}else{if(document.mozCancelFullScreen){document.mozCancelFullScreen()}else{if(document.webkitCancelFullScreen){document.webkitCancelFullScreen()}else{if(document.webkitExitFullScreen){document.webkitExitFullScreen()}}}}}};d.resize=function(){if(!d.isFullscreen()){d.screenStatus.isFull=false}else{d.screenStatus.isFull=true}var h=window.innerWidth;var g=window.innerHeight;for(m in f){if(h>f[m][0]&&g>f[m][1]){b(f[m][0],f[m][1]);c(f[m][0],f[m][1]);console.log("panel dimension changed, width="+f[m][0]+", height="+f[m][1]);break}}};function b(g,k){$("#background_screen").width(window.innerWidth);$("#background_screen").height(window.innerHeight);var i=document.getElementById("background_screen");i.width=g;i.height=k;$("#backgound_canvas").width(window.innerWidth);$("#backgound_canvas").height(window.innerHeight);var j=document.getElementById("backgound_canvas");j.width=g;j.height=k;d.bgeffects()}function c(i,l){$("#"+d.panelId).width(i);$("#"+d.panelId).height(l);var k=document.getElementById(d.panelId);k.width=i;k.height=l;d.dimension.width=i;d.dimension.height=l;d.dimension.hwidth=i;for(var l in e){if(e[l][0]==i){d.dimension.hheight=e[l][1];break}}var j;for(var g in a){if(a[g][0]==i){j=a[g][1].split(",");break}}d.dimension.awidth=parseInt(j[0]);d.dimension.aheight=parseInt(j[1]);d.dimension.swdith=i;d.dimension.sheight=d.dimension.aheight;var p=d.dimension.hheight;var o=i-d.dimension.awidth;var n=p;PANEL.screen.resize(0,p,d.dimension.swdith,d.dimension.sheight);PANEL.property.resize(o,n,d.dimension.awidth,d.dimension.aheight);PANEL.header.resize(0,0,d.dimension.hwidth,d.dimension.hheight)}return d}(PANEL||{}));PANEL.header=(function(){var b={PADDING:16};var c={};c.hoverIdx=-1;c.container=new createjs.Container();c.square=new createjs.Shape();c.container.addChild(c.square);c.Label1=new createjs.Text("","17px Arial","#eeffff");c.Label1.shadow=new createjs.Shadow("#090909",1,1,6);c.container.addChild(c.Label1);c.hover=new createjs.Shape();c.container.addChild(c.hover);c.enlarge=new createjs.Bitmap(MAINAPP.resource.get("app.res.km-icons-3-36x36-ngpng"));c.enlarge.shadow=new createjs.Shadow("#090909",1,1,1);c.container.addChild(c.enlarge);c.property=new createjs.Bitmap(MAINAPP.resource.get("app.res.km-icons-2-36x36-ngpng"));c.property.shadow=new createjs.Shadow("#090909",1,1,1);c.container.addChild(c.property);c.profile=new createjs.Bitmap(MAINAPP.resource.get("app.res.km-icons-4-36x36-ngpng"));c.profile.shadow=new createjs.Shadow("#090909",1,1,1);c.container.addChild(c.profile);c.stage=new createjs.Stage(PANEL.panelId);c.stage.addChild(c.container);function a(d,f){var e=c.container.getChildIndex(c.hover);c.container.removeChild(c.hover);c.hover=new createjs.Shape();c.container.addChildAt(c.hover,e);c.hover.graphics.beginFill("#5e5e5e").drawRect(d-b.PADDING/2,0,40+b.PADDING,PANEL.dimension.hheight);c.stage.update()}c.property.on("click",function(d){PANEL.property.hide();a(this.x,this.y)});c.enlarge.on("click",function(d){if(PANEL.isFullscreen()){PANEL.exitFullScreen()}else{PANEL.fullScreen()}a(this.x,this.y)});c.profile.on("click",function(d){a(this.x,this.y)});c.resize=function(e,i,f,g){var d=c.container.getChildIndex(c.square);c.container.removeChild(c.square);c.square=new createjs.Shape();c.container.addChildAt(c.square,d);c.square.x=0;c.square.y=0;c.square.graphics.beginFill("#1999d8").drawRect(e,i,f,g);c.Label1.x=10;c.Label1.y=(g-16)/2;c.Label1.text="NGO KidsMath "+PANEL.dimension.width+"X"+PANEL.dimension.height+","+PANEL.dimension.hheight+","+PANEL.dimension.awidth+"X"+PANEL.dimension.aheight;c.property.x=(f-c.property.image.width-b.PADDING);c.property.y=(g-c.property.image.height)/2;c.property.hitArea=new createjs.Shape();c.property.hitArea.graphics.beginFill("#FFF000").drawRect(0,0,40,40);c.enlarge.x=(c.property.x-c.enlarge.image.width-b.PADDING);c.enlarge.y=c.property.y;c.enlarge.hitArea=new createjs.Shape();c.enlarge.hitArea.graphics.beginFill("#FFF000").drawRect(0,0,40,40);c.profile.x=(c.enlarge.x-c.profile.image.width-b.PADDING);c.profile.y=c.enlarge.y;c.profile.hitArea=new createjs.Shape();c.profile.hitArea.graphics.beginFill("#FFF000").drawRect(0,0,40,40);c.stage.drawRect=new createjs.Rectangle(e,i,f,g);c.stage.update()};return c}());PANEL.property=(function(){var a={};a.container=new createjs.Container();a.square=new createjs.Shape();a.container.addChild(a.square);a.stage=new createjs.Stage(PANEL.panelId);a.stage.addChild(a.container);a.stage.alpha=0.9;a.resize=function(c,f,d,e){var b=a.container.getChildIndex(a.square);a.container.removeChild(a.square);a.square=new createjs.Shape();a.container.addChildAt(a.square,b);a.square.graphics.beginFill("#1999d8").drawRect(c,f,d,e);a.stage.drawRect=new createjs.Rectangle(c,f,d,e);a.stage.update()};a.hide=function(){a.container.visible=!a.container.visible;a.stage.update()};return a}());PANEL.screen=(function(){var a={};a.container=new createjs.Container();a.square=new createjs.Shape();a.container.addChild(a.square);a.Label1=new createjs.Text("","16px Arial","#F0FFF0");a.container.addChild(a.Label1);a.stage=new createjs.Stage(PANEL.panelId);a.stage.addChild(a.container);a.stage.alpha=0.3;a.resize=function(c,f,d,e){var b=a.container.getChildIndex(a.square);a.container.removeChild(a.square);a.square=new createjs.Shape();a.container.addChildAt(a.square,b);a.square.graphics.beginFill("#1F1F1F").drawRect(c,f,d,e);a.Label1.x=c;a.Label1.y=f+10;a.Label1.text=MAINAPP.DEBUGINFO.toString();a.stage.drawRect=new createjs.Rectangle(c,f,d,e);a.stage.update()};return a}());var MAIMUI=(function(){var a=[];function b(g){a.push(g);console.log("resize Events registed")}function d(){for(var h=0;h<a.length;h++){var g=a[h];g()}}function c(){PANEL.resize()}function f(){if(window.orientation===180||window.orientation===0){PANEL.screenStatus.orientation=1;alert("当前为竖屏，请切换为横屏以获得更好的显示效果！")}if(window.orientation===90||window.orientation===-90){PANEL.screenStatus.orientation=0}}function e(){window.addEventListener("resize",d,false);window.addEventListener("onorientationchange" in window?"orientationchange":"resize",f,false);b(c);d()}return{init:e}})();